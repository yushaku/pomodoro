<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="stylesheet" href="./assets/css/flipClock.css"/>
      <link rel="stylesheet" href="./assets/css/main.css" />
      <link rel="shortcut icon" type="image/png" href="./assets/img/favicon.png"/>
      <title>yushaku</title>
   </head>
   <body>
      <div class="container">
         <header>
            <div class="wapper">
               <div class="logo">
                  <a href="#"> Yushaku </a>
               </div>
               <div class="navbar">
                  <ul>
                     <li>
                        <ion-icon name="bar-chart-outline"></ion-icon>
                        <span>Report</span>
                     </li>
                     <li class="settingBtn">
                        <ion-icon name="settings-outline"></ion-icon>
                        <span>Setting</span>
                     </li>
                  </ul>
                  <img src="./assets/img/loveYourselfjpg.jpg" alt="" />
               </div>
            </div>
         </header>

         <!-- ?rel=0&autoplay=1 -->
         <div id="banner">
            <div class="img" style="background: rgba(51, 51, 51, 0.205) url('./assets/img/rose.jpg') no-repeat top left;"></div>
         </div>

         <div class="pomodoro ">
            <div class="title">
               <h1 class="titleH1">pomodoro</h1>
            </div>
            <audio src="./assets/music/pikachu.mp3" id="pip"></audio>
            <div id="clock-container">
               <div class="clock"></div>
            </div>

            <div id="pomodoroTask">
               
            </div>
            <div id="buttons">
               <button class="btn btnStart display">start</button>
               <button class="btn btnContinue">continue</button>
               <button class="btn btnExit">Exit</button>
            </div>
         </div>

         <div class="todo">
            <div id="inputForm">

               <input class="todoInput" type="text" placeholder="Add a task" />
               <div class="todoExpand">
                  <select class="selectInput">
                     <option value="" disabled selected>Prioritize</option>
                     <option value="flag1">F1</option>
                     <option value="flag2">F2</option>
                     <option value="flag3">F3</option>
                     <option value="flag4">F4</option>
                  </select>
                  <input class="deadlineInput" type="date" required>
                  <input class="counterInput" type="number" placeholder="pomodoro">
               </div>
               <div class="optionBtn">
                  <button class="saveTodo">Save</button>
                  <button class="cancelTodo">cancel</button>
               </div>
            </div>
            <div class="tastList">

               <div class="listItem">
                  <div class="listItem_finish">
                     <ion-icon name="ellipse-outline"></ion-icon>
                  <audio id="finishTodo" src="./assets/music/finish.mp3"></audio>
                  </div>
                  <div class="listItem_detail">
                     <h1>day là title</h1>
                     <div class="listItem_detail-mini">
                        <span class="prioritize flag1">F1</span>
                        <span>18/2/2000</span>
                     </div>
                  </div>
                  <div class="listItem_trash ">
                     <ion-icon name="star"></ion-icon>
                  </div>
               </div>


            </div>
            <div class="listItem_expand">

               <div class="listItem_expand-top">
                  <h1 contenteditable="true">day là title</h1>
                  <button class="toWork" onclick="toWork()">fuck this up</button>
               </div>

               <div class="TaskInput">
                  <input class="miniTaskInput" type="text" placeholder="Add one more step..." />
                  <button class="addMiniTodo">Add</button>
               </div>

               <div class="miniList">
                  <div class="miniList-item">
                     <ion-icon name="ellipse-outline"></ion-icon>
                     <h1 contenteditable="true">day là title</h1>
                  </div>
               </div>
               <textarea name="desciption" class="desciption" placeholder="Desciption here..."> </textarea>
               <div class="btnBLock">
                  <button class="btnCancel">cancel</button>
                  <button class="btnSave">Save</button>
               </div>
            </div>


         </div>

         <div class="backgroundSetting">
            <h1>Background</h1>

            <div class="themeBlock">
               <div class="theme">
                  <h2>image</h2>
                  <div class="themeList"></div>
               </div>

               <div class="video">
                  <h2>video</h2>
                  <div class="videoList"></div>
               </div>
            </div>
         </div>

         <div id="setting" class="">
            <div class="heading"><h1>Setting</h1></div>
            <div class="body">
               <form class="timeSetting">
                  <div class="study">
                     <label for="studyTime">Study</label>
                     <input type="number" id="studyTime" />
                  </div>
                  <div class="break">
                     <label for="breakTime">Break</label>
                     <input type="number" id="breakTime" />
                  </div>
                  <div class="longBreak">
                     <label for="longBreakTime">Long break</label>
                     <input type="number" id="longBreakTime" />
                  </div>
               </form>
               <form class="switchBlock">
                  <div class="autoBreak">
                     <h2>Auto start Breaks?</h2>
                     <label>
                        <input type="checkbox" name="" id="autoStartBreak" />
                        <span><i></i></span>
                     </label>
                  </div>
                  <div class="autoStudy">
                     <h2>Auto start Pomodoros?</h2>
                     <label>
                        <input type="checkbox" name="" id="autoStartStudy" />
                        <span><i></i></span>
                     </label>
                  </div>
                  <div class="interval">
                     <h2>Long Break interval</h2>
                     <input type="number" name="" id="breakInerval" />
                  </div>
                  <button class="apply">Apply</button>
               </form>
            </div>
         </div>

         <div class="musicBlock">
            <div class="player">
               <!-- Dashboard -->
               <div class="dashboard">
                  <!-- Header -->
                  <div class="songTitle">
                     <h2>this is name of song</h2>
                  </div>

                  <!-- CD -->
                  <div class="cd">
                     <div
                        class="cd-thumb"
                        style="background-image: url('https://i.ytimg.com/vi/jTLhQf5KJSc/maxresdefault.jpg')"
                     ></div>
                  </div>

                  <!-- Control -->
                  <div class="control">
                     <div class="btn btn-repeat">
                        <ion-icon name="repeat-outline"></ion-icon>
                     </div>
                     <div class="btn btn-prev">
                        <ion-icon name="play-skip-back-outline"></ion-icon>
                     </div>

                     <div class="btn btn-toggle-play">
                        <ion-icon name="play-outline"></ion-icon>
                        <ion-icon name="pause-outline"></ion-icon>
                     </div>

                     <div class="btn btn-next">
                        <ion-icon name="play-skip-forward-outline"></ion-icon>
                     </div>
                     <div class="btn btn-random">
                        <ion-icon name="shuffle-outline"></ion-icon>
                     </div>
                  </div>

                  <input id="progress" class="progress" type="range" value="0" step="1" min="0" max="100" />

                  <audio id="audio" src=""></audio>
               </div>

               <!-- Playlist -->
               <div class="playlist"></div>
            </div>
         </div>

         <footer>
            <ul>
               <li class="feature">
                  <ion-icon class="featureTodo" name="clipboard"></ion-icon>
               </li>
               <li class="feature">
                  <ion-icon class="featureBG" name="shirt"></ion-icon>
               </li>
               <li class="feature">
                  <ion-icon class="featureSong" name="musical-notes"></ion-icon>
               </li>
            </ul>
         </footer>
      </div>

      <!-- flip clock -->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment-with-locales.min.js" integrity="sha512-LGXaggshOkD/at6PFNcp2V2unf9LzFq6LE+sChH7ceMTDP0g2kn6Vxwgg7wkPP7AAtX+lmPqPdxB47A0Nz0cMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/flipclock/0.7.8/flipclock.min.js"></script>
      <script src="./assets/javascript/todo.js"></script>
      <script>
         const titleH1 = $(".titleH1");
         const btnStart = $(".btnStart");
         const btnContinue = $(".btnContinue");
         const btnExit = $(".btnExit");

         
         const config = JSON.parse(localStorage.getItem("POMODORO_SETTING")) || [];
         let studyTime = config.studyTime ?? 25;
         let breakTime = config.breakTime ?? 5;
         let longBreakTime = config.longBreakTime ?? 15;

         let countSession = 0;
         let LongbreakInterval = config.breakInerval ?? 4;
         let isAutoStudy = config.autoStartStudy ?? false;
         let isAutoBreak = config.autoStartBreak ?? false;


         const clock = $(".clock").FlipClock(0, {
            clockFace: "MinuteCounter",
            countdown: true,
            autoStart: false,
            callbacks: {
               interval: function () {
                  if (clock.getTime() == 0) {
                     if (titleH1.html() == "session") {
                        countSession++;
                        $("#pip").play();

                        workDoneSection(document.querySelector('#pomodoroTask p').getAttribute('id-work') ?? 0);

                        if (countSession == LongbreakInterval) {
                           countSession = 0;
                           titleH1.html("long break");
                           clock.setTime(longBreakTime * 60);
                           btnStart.html("start");
                           isAutoBreak ? clock.start() : clock.stop();
                        } else {
                           clock.setTime(breakTime * 60);
                           isAutoBreak ? clock.start() : clock.stop();
                           titleH1.html("break");
                           btnStart.html("start");
                        }
                     } else if (titleH1.html() == "break") {
                        clock.setTime(studyTime * 60);
                        titleH1.html("session");
                        btnStart.html("start");
                        pip.play();
                        isAutoStudy ? clock.start() : clock.stop();
                     } else {
                        clock.setTime(studyTime * 60);
                        titleH1.html("session");
                        pip.play();
                        isAutoStudy ? clock.start() : clock.stop();
                     }
                  }
               },
            },
         });
         clock.setTime(studyTime * 60);
         btnStart.on("click", function () {
            if (btnStart.html() == "start") {
               btnStart.html("pause");
               titleH1.html("session");
               clock.start();
            } else if (btnStart.html() == "pause") {
               clock.stop();
               btnStart.removeClass("display");
               btnContinue.addClass("display");
               btnExit.addClass("display");
            }
         });
         btnContinue.on("click", function () {
            clock.start();
            btnStart.addClass("display");
            btnContinue.removeClass("display");
            btnExit.removeClass("display");
         });
         btnExit.on("click", function () {
            clock.setTime(studyTime * 60);
            btnStart.html("start");
            btnStart.addClass("display");
            btnContinue.removeClass("display");
            btnExit.removeClass("display");
         });
      </script>

      <!-- components -->
      <script src="./assets/javascript/music.js"></script>
      <script src="./assets/javascript/setting.js"></script>

      <!-- icon online  -->
      <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
      <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
   </body>
</html>
